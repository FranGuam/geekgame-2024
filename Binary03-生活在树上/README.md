### 题面

小 R 同学是个计算机系的学生。他听说在数据结构的课上，要求手搓二叉树。

小 R 同学虽然不会写二叉树，但是他认真思考，进行了多次尝试。

在一开始，小 R 同学不知道动态分配内存为何物，于是**在栈上开辟出数组，**用来插入申请的节点，为了不产生溢出。他做了必要的检查。

小 R 同学继续学习，此时他不仅学了**堆空间**，更接触到了**链表的数据结构**。小 R 同学灵光一现：链表也就是一种特殊的树吖！于是他手搓了一个链表，并且实现了基本操作。

最后，小 R 同学终于学到了**二叉树**，他发现这真是太神奇了！小 R 同学动手搓了一个基础版的二叉树，并且按照他的理解进行了创新。

你看到了小 R 同学的三份代码，发现其中都存在漏洞。你决定利用这些漏洞，让小 R 同学明白内存安全的重要性。（小 R 同学：别骂了我错了，下次一定注意qwq）

### 提示

- 这类题属于 pwn 类型，需要找到二进制程序的漏洞并且加以利用，构造恶意输入来 get shell (对于本题中的程序，如果在远程可以成功执行 `system("/bin/sh")` 即可提权)
- level1: 有师傅反映有执行到 `backdoor` 之后会 crash,可以看一下 crash 的那一条指令对栈对齐有什么要求(本地调试请用 ubuntu 22.04 及以上版本)，然后如何解决（提示：可以在 ROPchain 中加 ret 指令来升栈）
- level2: 可以试一下劫持结构体中函数指针为 `backdoor`
- level3: libc 2.31 的堆 pwn 可以用 tcache poisoning，拿到任意写后打 free_hook

### 解答